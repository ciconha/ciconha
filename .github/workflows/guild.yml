name: Guild Card

on:
  schedule:
    - cron: "0 0 * * *"  # roda todo dia à meia-noite
  workflow_dispatch:      # permite rodar manualmente

permissions:
  contents: write         # permite salvar o arquivo no repositório

jobs:
  gerar-cartao:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout do repositório
        uses: actions/checkout@v4

      - name: Gerar cartão da guilda em HTML
        run: |
          mkdir -p cards
          echo "<!DOCTYPE html>
          <html lang='pt-BR'>
          <head>
            <meta charset='UTF-8'>
            <meta name='viewport' content='width=device-width, initial-scale=1.0'>
            <title>Cartão da Guilda - ciconha</title>
            <link rel='stylesheet' href='../style.css'>
          </head>
          <body>
            <div class='card'>
              <h1>Cartão da Guilda</h1>
              <p><strong>Nome:</strong> ciconha</p>
              <p><strong>Classe:</strong> Feiticeiro</p>
              <p><strong>Nível:</strong> 42</p>
              <p><strong>Servidor:</strong> Minecraft</p>
            </div>
          </body>
          </html>" > cards/ciconha.html

      - name: Gerar CSV da guilda
        run: |
          echo "nome,classe,nivel,servidor" > cards/ciconha.csv
          echo "ciconha,Feiticeiro,42,Minecraft" >> cards/ciconha.csv

      - name: Commit e Push dos arquivos
        run: |
          git config user.name "github-actions"
          git config user.email "github-actions@github.com"
          git add cards/
          git commit -m "Cartão da guilda gerado automaticamente"
          git push
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
