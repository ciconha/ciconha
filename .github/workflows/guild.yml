name: Guild Card Generator

on:
  workflow_dispatch:
    inputs:
      github_username:
        description: "GitHub username para gerar o cartÃ£o"
        required: true
        default: "ciconha"
      card_style:
        description: "Estilo visual do cartÃ£o"
        required: false
        default: "medieval"
      force_regenerate:
        description: "ForÃ§ar regeneraÃ§Ã£o do cartÃ£o"
        required: false
        default: false
        type: boolean
  push:
    branches: [ main, master ]
    paths:
      - ".github/workflows/guild.yml.yml"
  schedule:
    - cron: "0 0 * * *"

permissions:
  contents: write
  pages: write
  id-token: write

env:
  WORKFLOW_NAME: "Guild Card Generator"
  DEFAULT_USERNAME: "ciconha"

jobs:
  generate-guild-card:
    name: ðŸŽ¨ Gerar CartÃ£o da Guilda
    runs-on: ubuntu-latest
    env:
      USERNAME: ${{ github.event.inputs.github_username || env.DEFAULT_USERNAME }}
      CARD_STYLE: ${{ github.event.inputs.card_style || 'medieval' }}
      FORCE_REGENERATE: ${{ github.event.inputs.force_regenerate || false }}
    steps:
      - name: ðŸ§© Checkout do repositÃ³rio
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          fetch-depth: 0

      - name: ðŸ“¦ Configurar ambiente
        run: |
          sudo apt-get update
          sudo apt-get install -y curl jq bc imagemagick
          echo "ðŸŽ¯ Workflow: ${{ env.WORKFLOW_NAME }}"
          echo "ðŸ‘¤ UsuÃ¡rio: ${{ env.USERNAME }}"
